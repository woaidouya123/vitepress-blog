# [672.灯泡开关Ⅱ](https://leetcode.cn/problems/bulb-switcher-ii)
<span class="diff diff-medium">中等</span>
2022-09-15 20:28:29 `枚举` `TypeScript`
## 题目
<p>房间中有 <code>n</code>&nbsp;只已经打开的灯泡，编号从 <code>1</code> 到 <code>n</code> 。墙上挂着 <strong>4 个开关</strong> 。</p>

<p>这 4 个开关各自都具有不同的功能，其中：</p>

<ul>
  <li><strong>开关 1 ：</strong>反转当前所有灯的状态（即开变为关，关变为开）</li>
  <li><strong>开关 2 ：</strong>反转编号为偶数的灯的状态（即 <code>0, 2, 4, ...</code>）</li>
  <li><strong>开关 3 ：</strong>反转编号为奇数的灯的状态（即 <code>1, 3, ...</code>）</li>
  <li><strong>开关 4 ：</strong>反转编号为 <code>j = 3k + 1</code> 的灯的状态，其中 <code>k = 0, 1, 2, ...</code>（即 <code>1, 4, 7, 10, ...</code>）</li>
</ul>

<p>你必须 <strong>恰好</strong> 按压开关 <code>presses</code> 次。每次按压，你都需要从 4 个开关中选出一个来执行按压操作。</p>

<p>给你两个整数 <code>n</code> 和 <code>presses</code> ，执行完所有按压之后，返回 <strong>不同可能状态</strong> 的数量。</p>

<p>&nbsp;</p>

<p><strong>示例 1：</strong></p>

<pre>
<strong>输入：</strong>n = 1, presses = 1
<strong>输出：</strong>2
<strong>解释：</strong>状态可以是：
- 按压开关 1 ，[关]
- 按压开关 2 ，[开]
</pre>

<p><strong>示例 2：</strong></p>

<pre>
<strong>输入：</strong>n = 2, presses = 1
<strong>输出：</strong>3
<strong>解释：</strong>状态可以是：
- 按压开关 1 ，[关, 关]
- 按压开关 2 ，[开, 关]
- 按压开关 3 ，[关, 开]
</pre>

<p><strong>示例 3：</strong></p>

<pre>
<strong>输入：</strong>n = 3, presses = 1
<strong>输出：</strong>4
<strong>解释：</strong>状态可以是：
- 按压开关 1 ，[关, 关, 关]
- 按压开关 2 ，[关, 开, 关]
- 按压开关 3 ，[开, 关, 开]
- 按压开关 4 ，[关, 开, 开]
</pre>

<p>&nbsp;</p>

<p><strong>提示：</strong></p>

<ul>
  <li><code>1 &lt;= n &lt;= 1000</code></li>
  <li><code>0 &lt;= presses &lt;= 1000</code></li>
</ul>


## 题解
### 思路
1. 先观察灯泡受开关影响的规律

|灯泡|开关1|开关2|开关3|开关4|
|:-:|:------:|:-----:|:-----:|:-----:|
|1|√| |√|√|
|2|√|√| | |
|3|√| |√| |
|4|√|√| |√|
|5|√| |√| |
|6|√|√| | |
|7|√| |√|√|
|8|√|√| | |
|9|√| |√| |
|10|√|√| |√|
|11|√| |√| |
|12|√|√| | |
|13|√| |√|√|

根据上面表格可以看出每6个连续灯泡受到开关的影响是重复的，故我们可以只分析前6个灯泡可能出现的不同状态，又因为（第$2$和第$4$）以及（第$3$和第$5$）灯泡受灯泡影响相同，故可只分析前4个灯泡的可能性。

2. 设按下4种开关的次数分别为a、b、c、d，由于偶数次按压相当于没按，所以有
    - 灯泡$1$的状态为`(a + c + d) % 2`
    - 灯泡$2$的状态为`(a + b) % 2`
    - 灯泡$3$的状态为`(a + c) % 2`
    - 灯泡$4$的状态为`(a + b + d) % 2`

由于灯泡$1$、$3$都受到开关1、3的影响，且灯泡$1$还受开关$4$的影响，所以如果$1$、$3$状态确定，则开关4按的次数也能确定，又由于灯泡$2$、$4$都受到开关1、2的影响，并且灯泡$4$也受开关4的影响，当开关4按的次数确定时，则灯泡$4$的状态也可确定，即根据前3个灯泡的状态可推出第$4$个灯泡的状态，故可只分析前3个灯泡的可能性。

3. 分析前$3$个灯泡的状态
当n == 1时，开关1、3、4对其造成影响，也只有开和关两种状态
当n == 2时，按一次有3种(`01`、`11`、`10`)，按2次及以上有4种。
当n == 3时，按一次有4种(`111`、`010`、`101`、`100`)，按2次有7种(`000`、`101`、`010`、`111`、`011`、`110`、`001`),3次及以上有8种。

### 代码
```typescript
function flipLights(n: number, k: number): number {
    if (k == 0) return 1
    if (n == 1) return 2
    else if (n == 2) return k == 1 ? 3 : 4;
    else return k == 1 ? 4 : k == 2 ? 7 : 8;
};
```
